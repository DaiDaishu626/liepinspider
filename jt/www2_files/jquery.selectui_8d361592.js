!function($,window,undefined){function Plugin(element,options){this.element=$(element),this.options=$.extend({},defaults,options),this.head=this.element.find(".selectui-head"),this.result=this.head.find("input:hidden"),this.resultText=this.head.find(".selectui-result"),this.drop=this.head.find(".selectui-drop"),this.list=this.element.find("ul"),this._defaults=defaults,this._name=pluginName,this.init()}var pluginName="SelectUI",lowerBrowser=window.VBArray&&!window.XMLHttpRequest||navigator.userAgent.indexOf("MSIE 7.0")>-1||navigator.userAgent.indexOf("SE 2.X")>-1,document=window.document,methodHandler=["destroy","refresh","add"],defaults={type:"click"};Plugin.prototype.init=function(){var that=this,dock=that.element.attr("data-dock"),size=that.element.attr("data-size"),adapter=that.element.attr("data-adapter"),maxHeight=parseInt(that.element.attr("data-maxHeight")||"350"),selectedItem,disabled=that.element.hasClass("selectui-disabled");lowerBrowser&&$("<i />").appendTo(that.drop),that.result.length>0&&that.result.attr("autocomplete","off"),that.result.attr("data-ui",that._name),that.drop.attr("data-name",that.result.attr("name")||""),"hover"===that.options.type?that.drop[that.options.type](function(){!disabled&&that.element.addClass("selectui-active")},function(){!disabled&&that.element.removeClass("selectui-active")}):that.drop.add(that.resultText).bind(that.options.type,function(event){var adapter=that.element.attr("data-adapter"),maxHeight=parseInt(that.element.attr("data-maxHeight")||"350"),adapterItem=that.list.find('li[data-value="'+adapter+'"]');disabled||($(".selectui-active").each(function(){!$.contains(this,event.target)&&$(this).removeClass("selectui-active")}),that.element.hasClass("selectui-active")?that.element.removeClass("selectui-active"):(that.element.addClass("selectui-active"),maxHeight&&that.list.height()>maxHeight&&(that.list.css({height:maxHeight+"px","overflow-y":"auto"}),adapter&&0===that.list.find('li[data-selected="selected"]').length&&adapterItem.length>0&&that.list.scrollTop(adapterItem.position().top)))),event.stopPropagation()}),that.list.delegate("li a","click",function(event){var li=$(this).closest("li");return li.addClass("active").attr("data-selected","selected").siblings("li.active").removeClass("active").removeAttr("data-selected"),that.result.length>0&&that.result.val(li.attr("data-value")||"").trigger("change"),that.resultText.text($(this).text()),that.options.callback&&that.options.callback.call(this,li.attr("data-value"),$(this).text()),0===$(this).attr("href").indexOf("javascript:")?($(".selectui-active").removeClass("selectui-active"),event.stopPropagation(),!1):void 0}),$(document).bind("click",function(){$(".selectui-active").removeClass("selectui-active")}),that.refresh()},Plugin.prototype.value=function(value){var that=this;return that.result.val(value),that.list.find('[data-selected="selected"]').removeClass("active").removeAttr("data-selected"),that.refresh(),that},Plugin.prototype.add=function(opt,index){var _option;Array.isArray(opt)||(opt=[opt]),1===opt.length&&opt.push(opt[0]),2===opt.length&&opt.push(!1),_option=$('<li data-value="'+opt[0]+'"'+(opt[2]?' data-selected="selected"':"")+'><a href="javascript:;">'+opt[1]+"</a></li>"),index===undefined?_option.prependTo(this.list):0===index?_option.appendTo(this.list):_option.insertBefore(this.list.find("li:eq("+index+")"))},Plugin.prototype.empty=function(){return this.result.val(""),this.resultText.text(""),this.list.empty(),this},Plugin.prototype.refresh=function(){var that=this,dock=that.element.attr("data-dock"),size=that.element.attr("data-size"),placeholder=that.result.attr("placeholder"),empty=""===that.resultText.html().replace(/&nbsp;/g,"").trim(),selectedItem;size&&that.head.width(parseFloat(size)+3.5+"em"),dock&&"false"!==dock?(that.list.css("right","auto"),!size&&that.head.width(Math.max(that.list.width(),that.head.width())),that.list.css("right","0"),lowerBrowser&&that.list.width(that.element.width()-2)&&that.list.css("overflow","hidden")):(that.list.css("right","auto"),lowerBrowser&&that.list.width(that.list.width()-2),that.list.width()<that.head.width()&&that.list.width(that.head.width())),selectedItem=that.list.find('li[data-selected="selected"]'),""===that.result.val()||empty?placeholder?that.resultText.text(placeholder):(0===selectedItem.length&&that.list.find("li").each(function(){$(this).attr("data-value")===that.result.val()&&$(this).attr("data-selected","selected")}),that.resultText.text(that.resultText.text()||" ")):0===selectedItem.length&&that.list.find("li").each(function(){$(this).attr("data-value")===that.result.val()&&$(this).attr("data-selected","selected")}),selectedItem=that.list.find('li[data-selected="selected"]'),selectedItem.length>0&&(selectedItem.addClass("active"),that.result.length>0&&that.result.val(selectedItem.attr("data-value")||""),that.resultText.text(selectedItem.find("a").text())),""===that.resultText.text()&&that.resultText.html("&nbsp;"),$(document).bind("click",function(){$(".selectui-active").removeClass("selectui-active")})},$.fn[pluginName]=$.fn[pluginName]||function(options){var args,method,isHandler,_plugin;if("string"==typeof options){if(args=arguments,method=options,isHandler=function(){for(var i=0;i<methodHandler.length;i++)if(methodHandler[i]===method)return!0;return!1},Array.prototype.shift.call(args),"check"==method)return!!this.data("plugin_"+pluginName);if(isHandler())return this.each(function(){var _plugin=$(this).data("plugin_"+pluginName);_plugin&&_plugin[method]&&_plugin[method].apply(_plugin,args)});if(_plugin=this.first().data("plugin_"+pluginName),_plugin&&_plugin[method])return _plugin[method].apply(_plugin,args);throw new TypeError(pluginName+' has no method "'+method+'"')}return this.each(function(){var _plugin=$(this).data("plugin_"+pluginName);_plugin||$(this).data("plugin_"+pluginName,new Plugin(this,options))})}}(jQuery,window);