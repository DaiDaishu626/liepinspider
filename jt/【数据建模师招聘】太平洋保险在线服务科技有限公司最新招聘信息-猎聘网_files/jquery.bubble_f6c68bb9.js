!function($,window,undefined){function Plugin(element,options){this.element=$(element),this.options=$.extend({},defaults,options),this.inited=!1,this._defaults=defaults,this._name=pluginName,this.init()}var pluginName="Bubble",document=window.document,methodHandler=["destroy","refresh"],defaults={ns:"",type:"click",position:"tl",content:"",offset:!1,size:"medium",theme:"inverse",close:!0,zindex:10,margin:0,width:"auto"};Plugin.prototype.init=function(){var that=this;"hover"===that.options.type?that.element.bind("mouseenter",function(){that.inited||that.preinit(),that.content(function(){that.show()})}).bind("mouseleave",function(){that.bubble.removeAttr("data-active"),window.setTimeout(function(){that.inited&&!that.bubble.attr("data-active")&&that.hide()},200)}):that.element.bind(that.options.type,function(event){that.inited||that.preinit(),that.content(function(){that.show()}),"click"===that.options.type&&event.stopPropagation()}),$(document).bind("click",function(){that.inited&&that.bubble.attr("data-active")&&that.hide()})},Plugin.prototype.preinit=function(){var that=this,parentNode=that.options.offset?$("body"):that.element.offsetParent();return that.bubble=$('<div class="bubbles bubbles-hide"><em class="bubble-arrow"></em><i class="bubble-arrow"></i><table><tr><td class="bubble-content"><i class="bubble-loading loadingui-a"></i></td></tr></table></div>').css("z-index",that.options.zindex).appendTo(parentNode),"auto"!==that.options.width&&that.bubble.css("width",that.options.width),that.bubbleContent=that.bubble.find(".bubble-content"),that.bubbleArrow=that.bubble.children("em.bubble-arrow"),that.bubble.addClass("bubbles-"+that.options.theme).addClass("bubbles-"+that.options.size).addClass("bubbles-"+that.options.position).addClass("bubbles-"+that.options.theme+"-"+that.options.position).addClass("bubbles-"+that.options.size+"-"+that.options.position).bind("mouseenter",function(){$(this).attr("data-active",!0)}).bind("mouseleave",function(){"hover"===that.options.type&&that.hide()}).bind("click",function(event){event.stopPropagation()}),that.options.close&&(that.bubbleClose=$('<em class="bubble-close">&times;</em>').appendTo(that.bubble),that.bubbleClose.bind("click",function(){that.hide(),"function"==typeof that.options.close&&that.options.close.call(that)})),that.options.ns&&that.bubble.attr("data-bubble-ns",that.options.ns),that.inited=!0,that},Plugin.prototype.content=function(){var content,callback,i,ajax,success,that=this;for(i=0;i<arguments.length;i++)"function"==typeof arguments[i]?callback=arguments[i]:content=arguments[i];return content||(content=that.options.content),"object"==typeof content?(ajax=$.extend({type:"get",cache:!1},content),success=ajax.success,ajax.success=function(data){success?success(data,function(d){that.options.content=d,that.bubbleContent.html(d),that.position(),callback&&callback.call(that)}):(that.bubbleContent.html(data),that.position(),callback&&callback.call(that))},LT.ajax(ajax)):"string"==typeof content&&(that.bubbleContent.html(content),that.position(),callback&&callback.call(that)),that},Plugin.prototype.position=function(position){var that=this,offset=that.options.offset?that.element.offset():that.element.position(),getPix=function(ele,css){return parseInt(ele.css(css).replace(/[^\d\.]/gi,"")||"0")},elementProp={size:{width:that.element.outerWidth(),height:that.element.outerHeight()},margin:{top:getPix(that.element,"margin-top"),right:getPix(that.element,"margin-right"),bottom:getPix(that.element,"margin-bottom"),left:getPix(that.element,"margin-left")}},bubbleProp={size:{width:that.bubble.outerWidth(),height:that.bubble.outerHeight()},border:{width:getPix(that.bubble,"border-left-width")}},arrowProp={size:{width:that.bubbleArrow.outerWidth(),height:that.bubbleArrow.outerHeight()},position:{top:getPix(that.bubbleArrow,"top"),bottom:getPix(that.bubbleArrow,"bottom"),left:getPix(that.bubbleArrow,"left"),right:getPix(that.bubbleArrow,"right")}};switch(position||(position=that.options.position),position){case"lb":that.bubble.css({left:offset.left-bubbleProp.size.width-arrowProp.size.width/2+elementProp.margin.left-that.options.margin,top:offset.top+elementProp.size.height/2-arrowProp.position.top-arrowProp.size.height/2-bubbleProp.border.width+elementProp.margin.top});break;case"lt":that.bubble.css({left:offset.left-bubbleProp.size.width-arrowProp.size.width/2+elementProp.margin.left-that.options.margin,top:offset.top+elementProp.size.height/2-bubbleProp.size.height+arrowProp.position.bottom+bubbleProp.border.width+arrowProp.size.height/2+elementProp.margin.top});break;case"rb":that.bubble.css({left:offset.left+elementProp.size.width+arrowProp.size.width/2+elementProp.margin.left+that.options.margin,top:offset.top+elementProp.size.height/2-arrowProp.position.top-arrowProp.size.height/2-bubbleProp.border.width+elementProp.margin.top});break;case"rt":that.bubble.css({left:offset.left+elementProp.size.width+arrowProp.size.width/2+elementProp.margin.left+that.options.margin,top:offset.top+elementProp.size.height/2-bubbleProp.size.height+arrowProp.position.bottom+bubbleProp.border.width+arrowProp.size.height/2+elementProp.margin.top});break;case"tr":that.bubble.css({left:offset.left+elementProp.size.width/2-bubbleProp.border.width-arrowProp.position.left-arrowProp.size.width/2+elementProp.margin.left,top:offset.top-bubbleProp.size.height-arrowProp.size.height/2+elementProp.margin.top-that.options.margin});break;case"tl":that.bubble.css({left:offset.left+elementProp.size.width/2-bubbleProp.size.width+arrowProp.position.right+bubbleProp.border.width+arrowProp.size.width/2+elementProp.margin.left,top:offset.top-bubbleProp.size.height-arrowProp.size.height/2+elementProp.margin.top-that.options.margin});break;case"bl":that.bubble.css({left:offset.left+elementProp.size.width/2-bubbleProp.size.width+arrowProp.position.right+bubbleProp.border.width+arrowProp.size.width/2+elementProp.margin.left,top:offset.top+elementProp.size.height+arrowProp.size.height/2+elementProp.margin.top+that.options.margin});break;case"br":that.bubble.css({left:offset.left+elementProp.size.width/2-bubbleProp.border.width-arrowProp.position.left-arrowProp.size.width/2+elementProp.margin.left,top:offset.top+elementProp.size.height+arrowProp.size.height/2+elementProp.margin.top+that.options.margin})}return that},Plugin.prototype.show=function(){return this.bubble.attr("data-active",!0),this.options.ns&&$('.bubbles[data-bubble-ns="'+this.options.ns+'"]').addClass("bubbles-hide"),this.bubble.removeClass("bubbles-hide"),this},Plugin.prototype.hide=function(){return this.bubble.removeAttr("data-active"),this.bubble.addClass("bubbles-hide"),this},$.fn[pluginName]=$.fn[pluginName]||function(options){var args,method,isHandler,_plugin;if("string"==typeof options){if(args=arguments,method=options,isHandler=function(){for(var i=0;i<methodHandler.length;i++)if(methodHandler[i]===method)return!0;return!1},Array.prototype.shift.call(args),"check"==method)return!!this.data("plugin_"+pluginName);if(isHandler())return this.each(function(){var _plugin=$(this).data("plugin_"+pluginName);_plugin&&_plugin[method]&&_plugin[method].apply(_plugin,args)});if(_plugin=this.first().data("plugin_"+pluginName),_plugin&&_plugin[method])return _plugin[method].apply(_plugin,args);throw new TypeError(pluginName+' has no method "'+method+'"')}return this.each(function(){var _plugin=$(this).data("plugin_"+pluginName);_plugin||$(this).data("plugin_"+pluginName,new Plugin(this,options))})}}(jQuery,window);